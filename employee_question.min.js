'use strict';$(function(){'use strict';function a(s){return 0<s.length?new VirtualList({w:h.width,h:500,itemHeight:60,totalRows:s.length,generatorFn:function generatorFn(t){var u='',v='';s[t].name===window.respondentData.actualRespondent&&(u=' actual-resp',v='<span class="selected-notify">'+window.respondentData.selfSelection+'</span>'),-1!==q.indexOf(s[t].name)&&(u+=' listitem-selected',v='<span class="selected-notify">'+window.respondentData.alreadySelected+'</span>');var w=['<div class="listitem',u,'"><p class="listitem-name">',c(s[t],v),'</p>','<p class="listitem-dept">',s[t].department,'</p></div>'].join('');return $.parseHTML(w)[0]}}):'Noresult'}function b(){var s=a(n);g.find('.list-container').remove(),'Noresult'!==s&&g.append(s.container)}function c(s,t){var u,v=s.name;if(0<s.length){var w=v.slice(0,s.index),x=v.slice(s.index,s.index+s.length),y=v.slice(s.index+s.length,v.length);u=[w,'<b>',x,'</b>',y].join('')}else u=s.name;return 0<t.length&&(u+=t),u}function f(){var s=$(this).val();''===s?k.attr('src','/static/css/images/search.min.svg'):k.attr('src','/static/css/images/delete.min.svg'),n=window.respondents.filter(function(t){var u=t.name.toLowerCase().indexOf(s.toLocaleLowerCase());return-1!==u&&(t.index=u,t.length=s.length,!0)}),b(n)}var g=$('#search-result'),h=$('#search-input'),j=h.find('input'),k=h.find('img'),l=$('#selected-persons'),m=$('#btn-next'),n=[],o=$('form[name=\'answers\']'),p=0,q=[];o.find('input[type="text"]').each(function(s,t){var u=$(t);1<u.val().length&&-1===q.indexOf(u.val())&&(q.push(u.val()),p++,l.append('<span class="selected">'+u.val()+'<img class="selected-close" src="/static/css/images/delete.min.svg"></span>')),4==p&&(h.css('display','none'),m.css('display','block'))}),j.on('keyup paste focus',function(){f.call(this)});var r=function(){0==p?j.attr('placeholder',window.respondentData.initialPlaceholder):j.attr('placeholder',window.respondentData.placeholderText[p-1])};r(),$(document).on('mousedown','.listitem',function(s){var t=$(s.currentTarget),u=t.find('.listitem-name').text();if(4>p){q.push(u),l.append('<span class="selected">'+u+'<img class="selected-close" src="/static/css/images/delete.min.svg"></span>');var v=o.find('input[type="text"]').filter(function(w,x){return!$(x).val()});v.first().val(u),p++,r(),4==p?(h.css('display','none'),m.css('display','block')):j.val('')}g.find('.list-container').remove(),j.blur(),k.attr('src','/static/css/images/search.min.svg')}),$(document).on('mousedown','.selected-close',function(s){4==p&&(h.css('display','block'),m.css('display','none'),j.val(''),g.find('.list-container').remove()),p--,r();var t=$(s.currentTarget).parent(),u=t.text();q=q.filter(function(w){return w!==u}),t.remove();var v=o.find('input[type="text"]').filter(function(w,x){return $(x).val()===u});v.val(''),v=g.find('.listitem-selected').filter(function(w,x){return $(x).find('.listitem-name').clone().children().remove().end().text()===u}),v.removeClass('listitem-selected'),v.find('p span').remove()}),k.on('click',function(){'/static/css/images/delete.min.svg'===k.attr('src')?(g.find('.list-container').remove(),j.val(''),k.attr('src','/static/css/images/search.min.svg')):f.call(j[0])}),$('#next').on('click',function(){o.find('#id_next_page').prop('checked',!0),o.submit()}),$('#back').on('click',function(){o.find('#id_next_page').prop('checked',!1),o.submit()})});